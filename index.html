<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ประกาศเวลาซักผ้า</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body { font-family: Arial; padding:20px; }
button { padding:6px 12px; margin-top:5px; }
#adminPanel { display:none; margin-top:15px; }
</style>
</head>

<body>

<h2>ประกาศเวลาซักผ้า</h2>

<p>เวลารับผ้า: <span id="pickupDisplay">ยังไม่มีประกาศ</span></p>
<p>เวลาส่งผ้า: <span id="deliveryDisplay">ยังไม่มีประกาศ</span></p>

<hr>

<h3>แอดมิน</h3>
<input type="password" id="adminPass" placeholder="รหัสผ่าน">
<button onclick="loginAdmin()">เข้าสู่ระบบ</button>

<div id="adminPanel">
  <p>รับผ้า:</p>
  <input type="datetime-local" id="pickupInput">
  <button onclick="saveTime('pickup')">บันทึก</button>

  <p>ส่งผ้า:</p>
  <input type="datetime-local" id="deliveryInput">
  <button onclick="saveTime('delivery')">บันทึก</button>
</div>

<script>
var firebaseConfig = {
  apiKey: "AIzaSyAF0L8SlhyPjzmv1W12iPCd6tmSygvidXI",
  authDomain: "pcc-laundry.firebaseapp.com",
  databaseURL: "https://pcc-laundry-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "pcc-laundry",
  storageBucket: "pcc-laundry.firebasestorage.app",
  messagingSenderId: "792289941224",
  appId: "1:792289941224:web:4fbcb75441bac1be4a1b5d",
  measurementId: "G-MSWQSQCT7D"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();

function loginAdmin() {
  var pass = document.getElementById("adminPass").value;
  if(pass === "admin999"){
    document.getElementById("adminPanel").style.display = "block";
  } else {
    alert("รหัสผิด");
  }
}

function saveTime(type){
  var inputId = type === "pickup" ? "pickupInput" : "deliveryInput";
  var value = document.getElementById(inputId).value;

  if(!value){
    alert("กรุณาเลือกเวลา");
    return;
  }

  db.ref("times/" + type).set(value)
    .then(function(){
      alert("บันทึกสำเร็จ");
    })
    .catch(function(error){
      console.error(error);
      alert("บันทึกไม่สำเร็จ");
    });
}

db.ref("times").on("value", function(snapshot){
  var data = snapshot.val();

  if(data){
    if(data.pickup){
      document.getElementById("pickupDisplay").innerText = formatDate(data.pickup);
    }
    if(data.delivery){
      document.getElementById("deliveryDisplay").innerText = formatDate(data.delivery);
    }
  }
});

function formatDate(datetime){
  var d = new Date(datetime);
  return "วันที่ " + d.toLocaleDateString("th-TH") +
         " เวลา " + d.toLocaleTimeString("th-TH",{hour:'2-digit',minute:'2-digit'});
}
</script>

</body>
</html>
